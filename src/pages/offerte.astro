---
import Layout from '../layouts/Layout.astro';

const services = [
    'Nieuwbouw',
    'Renovatie',
    'Verbouw',
    'Onderhoud',
];

// SEO metadata
const pageTitle = "Gratis Offerte Aanvragen | Van Tilburg Kozijnen";
const pageDescription = "Vraag vrijblijvend een offerte aan voor uw kozijnen project. Ontvang binnen 24 uur een reactie van onze experts. Specialist in Accoya houten kozijnen met 50 jaar garantie.";
const pageKeywords = "kozijnen offerte, gratis offerte, kozijnen prijzen, accoya kozijnen prijs, houten kozijnen offerte, kozijnen berekenen, kozijnen kosten";
---

<Layout
  title={pageTitle}
  description={pageDescription}
  keywords={pageKeywords}
  image="/images/offerte-banner.jpg"
>
    <main class="pt-20">
        <!-- Schema.org Offer markup -->
        <script type="application/ld+json" set:html={JSON.stringify({
            "@context": "https://schema.org",
            "@type": "Service",
            "name": "Kozijnen Offerte Service",
            "description": "Gratis en vrijblijvende offerte voor kozijnen en deuren",
            "provider": {
                "@type": "HomeAndConstructionBusiness",
                "name": "R.VAN TILBURG KOZIJNEN",
                "url": "https://vantilburgkozijnen.nl"
            },
            "serviceType": "Quote Request",
            "availableChannel": {
                "@type": "ServiceChannel",
                "serviceUrl": "https://vantilburgkozijnen.nl/offerte",
                "servicePhone": "+31164672085",
                "availableLanguage": {
                    "@type": "Language",
                    "name": "Dutch"
                }
            },
            "termsOfService": "Gratis en vrijblijvend",
            "serviceOutput": "Gedetailleerde offerte binnen 24 uur",
            "areaServed": {
                "@type": "GeoCircle",
                "geoMidpoint": {
                    "@type": "GeoCoordinates",
                    "latitude": 51.3998,
                    "longitude": 4.3245
                },
                "geoRadius": "100000"
            }
        })}></script>

        <!-- Hero Section -->
        <section class="bg-bg-light py-20">
            <div class="container mx-auto px-4">
                <div class="max-w-4xl mx-auto text-center">
                    <h1 class="text-4xl md:text-5xl font-bold text-text-dark mb-6">Offerte Aanvragen</h1>
                    <p class="text-xl text-text-light">
                        Vraag vrijblijvend een offerte aan voor uw project
                    </p>
                </div>
            </div>
        </section>

        <!-- Quote Form -->
        <section class="py-20 bg-gradient-to-br from-gray-50 via-gray-50/95 to-gray-100/90">
            <div class="container mx-auto px-4">
                <div class="max-w-3xl mx-auto">
                    <div class="text-center mb-12">
                        <h1 class="text-4xl sm:text-5xl font-bold text-text-dark/90 mb-4 font-montreal">
                            Offerte Aanvragen
                        </h1>
                        <p class="text-lg text-text-light/80 max-w-2xl mx-auto">
                            Vul het formulier in en ontvang binnen 24 uur een vrijblijvende offerte voor uw project.
                        </p>
                    </div>
                    
                    <div class="backdrop-blur-md bg-white/90 rounded-xl p-6 sm:p-8 lg:p-12 shadow-[0_8px_32px_0_rgba(31,38,135,0.2)] border border-white/20">
                        <form id="quoteForm" class="space-y-8">
                            <!-- Personal Information -->
                            <div class="space-y-6">
                                <h2 class="text-2xl font-bold text-text-dark/90">Persoonlijke Gegevens</h2>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label for="firstName" class="block text-sm font-medium text-text-dark/90 mb-2">
                                            Voornaam
                                        </label>
                                        <input
                                            type="text"
                                            id="firstName"
                                            name="firstName"
                                            required
                                            class="w-full px-4 py-2 rounded-lg border border-gray-300/50 focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 backdrop-blur-sm bg-white/70 transition-all duration-200"
                                            placeholder="Uw voornaam"
                                        />
                                    </div>
                                    <div>
                                        <label for="lastName" class="block text-sm font-medium text-text-dark/90 mb-2">
                                            Achternaam
                                        </label>
                                        <input
                                            type="text"
                                            id="lastName"
                                            name="lastName"
                                            required
                                            class="w-full px-4 py-2 rounded-lg border border-gray-300/50 focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 backdrop-blur-sm bg-white/70 transition-all duration-200"
                                            placeholder="Uw achternaam"
                                        />
                                    </div>
                                    <div>
                                        <label for="email" class="block text-sm font-medium text-text-dark/90 mb-2">
                                            E-mail
                                        </label>
                                        <input
                                            type="email"
                                            id="email"
                                            name="email"
                                            required
                                            class="w-full px-4 py-2 rounded-lg border border-gray-300/50 focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 backdrop-blur-sm bg-white/70 transition-all duration-200"
                                            placeholder="Uw e-mailadres"
                                        />
                                    </div>
                                    <div>
                                        <label for="phone" class="block text-sm font-medium text-text-dark/90 mb-2">
                                            Telefoon
                                        </label>
                                        <input
                                            type="tel"
                                            id="phone"
                                            name="phone"
                                            required
                                            class="w-full px-4 py-2 rounded-lg border border-gray-300/50 focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 backdrop-blur-sm bg-white/70 transition-all duration-200"
                                            placeholder="Uw telefoonnummer"
                                        />
                                    </div>
                                </div>
                            </div>

                            <!-- Project Details -->
                            <div class="space-y-6">
                                <h2 class="text-2xl font-bold text-text-dark/90">Project Details</h2>
                                <div>
                                    <label for="service" class="block text-sm font-medium text-text-dark/90 mb-2">
                                        Type Project
                                    </label>
                                    <select
                                        id="service"
                                        name="service"
                                        required
                                        class="w-full px-4 py-2 rounded-lg border border-gray-300/50 focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 backdrop-blur-sm bg-white/70 transition-all duration-200"
                                    >
                                        <option value="">Selecteer type project</option>
                                        {services.map(service => (
                                            <option value={service}>{service}</option>
                                        ))}
                                    </select>
                                </div>
                                <div>
                                    <label for="location" class="block text-sm font-medium text-text-dark/90 mb-2">
                                        Locatie
                                    </label>
                                    <input
                                        type="text"
                                        id="location"
                                        name="location"
                                        required
                                        class="w-full px-4 py-2 rounded-lg border border-gray-300/50 focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 backdrop-blur-sm bg-white/70 transition-all duration-200"
                                        placeholder="Adres van het project"
                                    />
                                </div>
                                <div>
                                    <label for="description" class="block text-sm font-medium text-text-dark/90 mb-2">
                                        Projectomschrijving
                                    </label>
                                    <textarea
                                        id="description"
                                        name="description"
                                        rows="4"
                                        required
                                        class="w-full px-4 py-2 rounded-lg border border-gray-300/50 focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 backdrop-blur-sm bg-white/70 transition-all duration-200"
                                        placeholder="Beschrijf uw project en wensen..."
                                    ></textarea>
                                </div>
                            </div>

                            <div class="mt-8">
                                <button
                                    type="submit"
                                    class="w-full bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
                                >
                                    Offerte Aanvragen
                                </button>
                                <div id="quoteFormStatus" class="mt-4 text-center hidden">
                                    <p class="success hidden text-green-600">Bedankt voor uw aanvraag! We nemen binnen 24 uur contact met u op.</p>
                                    <p class="error hidden text-red-600">Er is iets misgegaan. Probeer het opnieuw of neem telefonisch contact op.</p>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </section>
    </main>
    <Footer />
</Layout>

<script>
  import { EMAILJS_CONFIG, initEmailJS, sendEmail } from '../lib/emailjs';

  // Initialize EmailJS
  initEmailJS();

  const quoteForm = document.getElementById('quoteForm') as HTMLFormElement;
  const formStatus = document.getElementById('quoteFormStatus');
  const successMessage = formStatus?.querySelector('.success');
  const errorMessage = formStatus?.querySelector('.error');
  
  quoteForm?.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const submitButton = quoteForm.querySelector('button[type="submit"]') as HTMLButtonElement;
    submitButton.disabled = true;
    
    try {
      const formData = new FormData(quoteForm);
      const templateParams = {
        from_name: formData.get('firstName') + ' ' + formData.get('lastName'),
        from_email: formData.get('email'),
        phone: formData.get('phone'),
        address: formData.get('location'),
        postal_code: '',
        city: '',
        project_description: formData.get('description'),
        preferred_contact: ''
      };

      await sendEmail(EMAILJS_CONFIG.QUOTE_TEMPLATE_ID, templateParams);

      // Show success message
      formStatus?.classList.remove('hidden');
      successMessage?.classList.remove('hidden');
      errorMessage?.classList.add('hidden');
      quoteForm.reset();
    } catch (error) {
      // Show error message
      formStatus?.classList.remove('hidden');
      errorMessage?.classList.remove('hidden');
      successMessage?.classList.add('hidden');
      console.error('Error:', error);
    } finally {
      submitButton.disabled = false;
    }
  });
</script>
